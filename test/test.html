<!doctype html>
<html>
  <head>
    <title>Raven.js Test Suite</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="../node_modules/mocha/mocha.css" />
  </head>
  <body>
    <div id="mocha"></div>
    <!-- Mocha -->
    <script src="../node_modules/mocha/mocha.js"></script>
    <script src="../node_modules/chai/chai.js"></script>
    <script>
        mocha.ui('bdd')
        mocha.reporter('html')
        expect = chai.expect
    </script>

    <!-- Mock XHR -->
    <script src="vendor/sinon-server-1.5.0.js"></script>
    <script src="vendor/sinon-ie-1.5.0.js"></script>

    <!-- Raven -->
    <script src="../src/vendor/uri.js"></script>
    <script src="../src/vendor/TraceKit/tracekit.js"></script>
    <script src="../src/raven.js"></script>

    <!-- Tests -->
    <script src="raven.test.js"></script>

    <script>
        if (window.mochaPhantomJS) mochaPhantomJS.run();
        else {
            (function(runner){
              var failed = [];

              runner.on('fail', function(test, err){
                failed.push({
                  title: test.title,
                  fullTitle: test.fullTitle(),
                  error: {
                    message: err.message,
                    stack: err.stack
                  }
                });
              });

              runner.on('end', function(){
                runner.stats.failed = failed;
                global.mochaResults = runner.stats;
              });
            })(mocha.run());
        }
    </script>
  </body>
</html>
