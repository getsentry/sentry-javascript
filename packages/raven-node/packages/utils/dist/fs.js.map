{"version":3,"file":"fs.js","sourceRoot":"","sources":["../src/fs.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,yBAAgD;AAChD,6BAAwC;AAExC,IAAM,KAAK,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;AAElC;;;;;;GAMG;AACH,oBAA0B,IAAY,EAAE,IAAY;;;YAClD,6EAA6E;YAC7E,gDAAgD;YAChD,sBAAO,IAAI,OAAO,CAAO,UAAC,GAAG,EAAE,MAAM;oBACnC,UAAK,CAAC,IAAI,EAAE,IAAI,EAAE,UAAA,GAAG;wBACnB,IAAI,GAAG,EAAE;4BACP,MAAM,CAAC,GAAG,CAAC,CAAC;yBACb;6BAAM;4BACL,GAAG,EAAE,CAAC;yBACP;oBACH,CAAC,CAAC,CAAC;gBACL,CAAC,CAAC,EAAC;;;CACJ;AAED;;;;;GAKG;AACH,gBAA6B,IAAY;;;;;;oBAEjC,IAAI,GAAG,KAAK,GAAG,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;oBAChC,QAAQ,GAAG,cAAO,CAAC,IAAI,CAAC,CAAC;;;;oBAG7B,sBAAO,UAAU,CAAC,QAAQ,EAAE,IAAI,CAAC,EAAC;;;oBAE5B,KAAK,GAAG,KAAuB,CAAC;yBAClC,CAAA,KAAK,IAAI,KAAK,CAAC,IAAI,KAAK,QAAQ,CAAA,EAAhC,wBAAgC;oBAClC,qBAAM,MAAM,CAAC,cAAO,CAAC,QAAQ,CAAC,CAAC,EAAA;;oBAA/B,SAA+B,CAAC;oBAChC,sBAAO,UAAU,CAAC,QAAQ,EAAE,IAAI,CAAC,EAAC;;oBAElC,IAAI;wBACF,IAAI,CAAC,aAAQ,CAAC,QAAQ,CAAC,CAAC,WAAW,EAAE,EAAE;4BACrC,MAAM,KAAG,CAAC;yBACX;qBACF;oBAAC,OAAO,CAAC,EAAE;wBACV,MAAM,KAAG,CAAC;qBACX;;;;;;;CAGN;AAtBD,wBAsBC;AAED;;;;GAIG;AACH,oBAA2B,IAAY;IACrC,sCAAsC;IACtC,IAAM,IAAI,GAAG,KAAK,GAAG,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;IACtC,IAAM,QAAQ,GAAG,cAAO,CAAC,IAAI,CAAC,CAAC;IAE/B,IAAI;QACF,cAAS,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;KAC3B;IAAC,OAAO,GAAG,EAAE;QACZ,IAAM,KAAK,GAAG,GAAuB,CAAC;QACtC,IAAI,KAAK,IAAI,KAAK,CAAC,IAAI,KAAK,QAAQ,EAAE;YACpC,UAAU,CAAC,cAAO,CAAC,QAAQ,CAAC,CAAC,CAAC;YAC9B,cAAS,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;SAC3B;aAAM;YACL,IAAI;gBACF,IAAI,CAAC,aAAQ,CAAC,QAAQ,CAAC,CAAC,WAAW,EAAE,EAAE;oBACrC,MAAM,GAAG,CAAC;iBACX;aACF;YAAC,OAAO,CAAC,EAAE;gBACV,MAAM,GAAG,CAAC;aACX;SACF;KACF;AACH,CAAC;AAtBD,gCAsBC","sourcesContent":["import { mkdir, mkdirSync, statSync } from 'fs';\nimport { dirname, resolve } from 'path';\n\nconst _0777 = parseInt('0777', 8);\n\n/**\n * Asynchronously creates the given directory.\n *\n * @param path A relative or absolute path to the directory.\n * @param mode The permission mode.\n * @returns A Promise that resolves when the path has been created.\n */\nasync function mkdirAsync(path: string, mode: number): Promise<void> {\n  // We cannot use util.promisify here because that was only introduced in Node\n  // 8 and we need to support older Node versions.\n  return new Promise<void>((res, reject) => {\n    mkdir(path, mode, err => {\n      if (err) {\n        reject(err);\n      } else {\n        res();\n      }\n    });\n  });\n}\n\n/**\n * Recursively creates the given path.\n *\n * @param path A relative or absolute path to create.\n * @returns A Promise that resolves when the path has been created.\n */\nexport async function mkdirp(path: string): Promise<void> {\n  // tslint:disable-next-line:no-bitwise\n  const mode = _0777 & ~process.umask();\n  const realPath = resolve(path);\n\n  try {\n    return mkdirAsync(realPath, mode);\n  } catch (err) {\n    const error = err as { code: string };\n    if (error && error.code === 'ENOENT') {\n      await mkdirp(dirname(realPath));\n      return mkdirAsync(realPath, mode);\n    } else {\n      try {\n        if (!statSync(realPath).isDirectory()) {\n          throw err;\n        }\n      } catch (_) {\n        throw err;\n      }\n    }\n  }\n}\n\n/**\n * Synchronous version of {@link mkdirp}.\n *\n * @param path A relative or absolute path to create.\n */\nexport function mkdirpSync(path: string): void {\n  // tslint:disable-next-line:no-bitwise\n  const mode = _0777 & ~process.umask();\n  const realPath = resolve(path);\n\n  try {\n    mkdirSync(realPath, mode);\n  } catch (err) {\n    const error = err as { code: string };\n    if (error && error.code === 'ENOENT') {\n      mkdirpSync(dirname(realPath));\n      mkdirSync(realPath, mode);\n    } else {\n      try {\n        if (!statSync(realPath).isDirectory()) {\n          throw err;\n        }\n      } catch (_) {\n        throw err;\n      }\n    }\n  }\n}\n"]}